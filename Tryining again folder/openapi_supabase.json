{
  "openapi": "3.1.1",
  "info": { "title": "Supabase REST for Scheduler", "version": "0.1" },
  "servers": [
    { "url": "https://nepbymodsswjokzvunca.supabase.co/rest/v1" }
  ],
  "components": {
    "securitySchemes": {
      "BearerAuth": { "type": "http", "scheme": "bearer" }
    },
    "schemas": {}
  },
  "security": [ { "BearerAuth": [] } ],
  "paths": {
    "/job_pool": {
      "get": {
        "operationId": "get_job_pool",
        "summary": "List job_pool rows (filter with PostgREST operators)",
        "parameters": [
          { "in": "query", "name": "select", "schema": { "type": "string" }, "example": "work_order,site_name,region,days_til_due,jp_status" },
          { "in": "query", "name": "jp_status", "schema": { "type": "string" }, "example": "neq.Scheduled" },
          { "in": "query", "name": "region", "schema": { "type": "string" }, "example": "eq.CO - Northeast" },
          { "in": "query", "name": "sow_1", "schema": { "type": "string" }, "example": "like.*ACI*" },
          { "in": "query", "name": "days_til_due", "schema": { "type": "string" }, "example": "lte.21" },
          { "in": "query", "name": "limit", "schema": { "type": "integer" }, "example": 50 }
        ],
        "responses": { "200": { "description": "OK" } }
      },
      "patch": {
        "operationId": "update_job_pool",
        "summary": "Update job_pool rows by filter",
        "parameters": [
          { "in": "query", "name": "work_order", "schema": { "type": "string" }, "example": "eq.67013" }
        ],
        "requestBody": {
          "required": true,
          "content": { "application/json": { "schema": { "type": "object" } } }
        },
        "responses": { "200": { "description": "OK" } }
      }
    },
    "/scheduled_jobs": {
      "post": {
        "operationId": "upsert_scheduled_jobs",
        "summary": "Upsert scheduled_jobs (use on_conflict=work_order)",
        "parameters": [
          { "in": "query", "name": "on_conflict", "schema": { "type": "string" }, "example": "work_order" }
        ],
        "requestBody": {
          "required": true,
          "content": { "application/json": { "schema": { "type": "array", "items": { "type": "object" } } } }
        },
        "responses": { "200": { "description": "OK" } }
      }
    },
    "/technicians": {
      "get": {
        "operationId": "get_technicians",
        "summary": "List technicians",
        "parameters": [
          { "in": "query", "name": "select", "schema": { "type": "string" }, "example": "technician_id,name,home_latitude,home_longitude" },
          { "in": "query", "name": "technician_id", "schema": { "type": "string" }, "example": "eq.374" },
          { "in": "query", "name": "limit", "schema": { "type": "integer" }, "example": 100 }
        ],
        "responses": { "200": { "description": "OK" } }
      }
    }
  }
}
